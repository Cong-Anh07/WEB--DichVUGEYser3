(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();const d={admin:{username:"admin",password:"nanogeyser2024!",email:"admin@nanogeyser.vn",name:"Quản trị viên Nanogeyser"},customer:{username:"customer",password:"customer123",email:"customer@email.com",name:"Nguyễn Văn A",phone:"0901234567"},company:{name:"Nanogeyser Vietnam",address:"123 Đường ABC, Quận 1, TP.HCM",phone:"1900 1234",email:"info@nanogeyser.vn",website:"https://nanogeyser.vn"},services:[{id:"maintenance",name:"Bảo dưỡng định kỳ",price:3e5,duration:"60-90 phút"},{id:"repair",name:"Sửa chữa",price:2e5,duration:"30-120 phút"},{id:"warranty",name:"Bảo hành",price:0,duration:"30-60 phút"},{id:"installation",name:"Lắp đặt",price:5e5,duration:"120-180 phút"}],contact:{hotline:"1900 1234",email:"support@nanogeyser.vn",address:"123 Đường ABC, Quận 1, TP.HCM",workingHours:"Thứ 2 - Chủ nhật: 8:00 - 20:00"}};window.CONFIG=d;const s={products:[],customers:[],bookings:[],technicians:[]},u={getProductById:e=>s.products.find(t=>t.id===e),getCustomerById:e=>s.customers.find(t=>t.id===e),getBookingsByCustomer:e=>s.bookings.filter(t=>t.customerId===e),formatCurrency:e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e),formatDate:e=>new Date(e).toLocaleDateString("vi-VN")};window.SAMPLE_DATA=s;window.DATA_UTILS=u;const i=document.querySelector(".hamburger"),l=document.querySelector(".nav-menu");i&&i.addEventListener("click",()=>{i.classList.toggle("active"),l.classList.toggle("active")});function f(){fetch("/api/user/user_list/").then(e=>e.json()).then(e=>{console.log("API Response:",e);const t=document.querySelectorAll(".service");e&&Array.isArray(e)?t.forEach((r,n)=>{e[n]&&e[n].name&&(r.textContent=e[n].name)}):e&&e.data&&Array.isArray(e.data)&&t.forEach((r,n)=>{e.data[n]&&e.data[n].name&&(r.textContent=e.data[n].name)})}).catch(e=>console.log("API Error:",e))}window.addEventListener("DOMContentLoaded",f);document.querySelectorAll(".nav-menu a").forEach(e=>e.addEventListener("click",()=>{i.classList.remove("active"),l.classList.remove("active")}));document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();const r=document.querySelector(this.getAttribute("href"));r&&r.scrollIntoView({behavior:"smooth",block:"start"})})});window.addEventListener("scroll",()=>{const e=document.querySelector(".header");window.scrollY>100?(e.style.background="rgba(255, 255, 255, 0.95)",e.style.backdropFilter="blur(10px)"):(e.style.background="#fff",e.style.backdropFilter="none")});document.addEventListener("DOMContentLoaded",function(){m()});function m(){fetch("https://api.chothuetatca.com/api/blog/list").then(e=>e.json()).then(e=>{document.getElementById("newsLoading").style.display="none",document.getElementById("newsGrid").style.display="grid";let t=[];e.data&&Array.isArray(e.data)?t=e.data.slice(0,6):Array.isArray(e)&&(t=e.slice(0,6)),h(t)}).catch(e=>{console.log("Error loading news:",e),document.getElementById("newsLoading").innerHTML='<p style="color:#666;">Không thể tải tin tức</p>'})}function h(e){const t=document.getElementById("newsGrid");if(e.length===0){t.innerHTML='<p style="text-align:center; color:#666; grid-column:1/-1;">Chưa có tin tức</p>';return}const r="https://api.chothuetatca.com";t.innerHTML=e.map(n=>{let a=n.image||n.thumbnail||n.avatar||"";a&&!a.startsWith("http")&&(a=r+a),a||(a="/public/images/logo.png");const o=`news-detail.html?id=${n.id}`;return`
            <div class="news-card" onclick="window.location.href='${o}'" style="cursor:pointer;">
                <div class="news-image">
                    <img src="${a}" alt="${n.title||n.name||"Tin tức"}" onerror="this.src='/public/images/logo.png'">
                </div>
                <div class="news-content">
                    <span class="news-date"><i class="fas fa-calendar"></i> ${g(n.created_at||n.date)}</span>
                    <h3>${n.title||n.name||"Tin tức"}</h3>
                    <p>${p(n.description||n.content||n.des||"",100)}</p>
                    <a href="${o}" class="news-link">Xem thêm <i class="fas fa-arrow-right"></i></a>
                </div>
            </div>
        `}).join("")}function g(e){if(!e)return"";try{return new Date(e).toLocaleDateString("vi-VN")}catch{return e}}function p(e,t){if(!e)return"";const r=e.replace(/<[^>]*>/g,"");return r.length<=t?r:r.substring(0,t)+"..."}document.addEventListener("DOMContentLoaded",function(){const e=JSON.parse(sessionStorage.getItem("currentUser")),t=document.getElementById("authNav"),r=document.getElementById("registerNav");e&&(t.innerHTML=`
                <div class="user-dropdown">
                    <a href="#" class="user-btn">
                        <i class="fas fa-user-circle"></i>
                        <span>${e.username||e.phone}</span>
                        <i class="fas fa-chevron-down"></i>
                    </a>
                    <div class="dropdown-menu">
                        <a href="booking.html"><i class="fas fa-calendar-plus"></i> Đặt lịch</a>
                        <a href="history-booking.html"><i class="fas fa-calendar-check"></i> Lịch sử đặt lịch</a>
                        <a href="history-filter.html"><i class="fas fa-filter"></i> Nhật ký thay lõi</a>
                        <a href="#" onclick="logout(); return false;"><i class="fas fa-sign-out-alt"></i> Đăng xuất</a>
                    </div>
                </div>
            `,r.style.display="none")});
